DELIMITER $$

DROP PROCEDURE IF EXISTS `GetHistoryPagesOver10` $$
CREATE DEFINER=`root`@`localhost` PROCEDURE `GetHistoryPagesOver10`()
BEGIN
SELECT * FROM (
SELECT tmpPrintouts.ID, tmpPrintouts.OrigID, pagenum, '1625-3' AS AgencyNumber,'Loaves & Fishes Food Pantry' AS AgencyName, LastName,CASE pagenum WHEN 1 THEN FirstName ELSE CONCAT(FirstName, " (page ", pagenum, ")") END AS FirstName, Address,City,State,Phone,AptNumber,CASE WHEN FoodStamps = 1 THEN 'Yes' ELSE 'No' END AS ListBox,FoodStampAmount,WorkerName AS NameOfWorker,DoB,Zip,Line1_Name,Line1_Age,Line1_Sex,Line1_Income,Line1_Monthly,Line1_Weekly,Line1_BiWeekly,Line1_Yearly,Line1_Medicaid,Line1_TANF,Line1_SSI,Line1_Other,Line2_Name,Line2_Age,Line2_Sex,Line2_Income,Line2_Monthly,Line2_Weekly,Line2_BiWeekly,Line2_Yearly,Line2_Medicaid,Line2_TANF,Line2_SSI,Line2_Other,Line3_Name,Line3_Age,Line3_Sex,Line3_Income,Line3_Monthly,Line3_Weekly,Line3_BiWeekly,Line3_Yearly,Line3_Medicaid,Line3_TANF,Line3_SSI,Line3_Other,Line4_Name,Line4_Age,Line4_Sex,Line4_Income,Line4_Monthly,Line4_Weekly,Line4_BiWeekly,Line4_Yearly,Line4_Medicaid,Line4_TANF,Line4_SSI,Line4_Other,Line5_Name,Line5_Age,Line5_Sex,Line5_Income,Line5_Monthly,Line5_Weekly,Line5_BiWeekly,Line5_Yearly,Line5_Medicaid,Line5_TANF,Line5_SSI,Line5_Other,Line6_Name,Line6_Age,Line6_Sex,Line6_Income,Line6_Monthly,Line6_Weekly,Line6_BiWeekly,Line6_Yearly,Line6_Medicaid,Line6_TANF,Line6_SSI,Line6_Other,Line7_Name,Line7_Age,Line7_Sex,Line7_Income,Line7_Monthly,Line7_Weekly,Line7_BiWeekly,Line7_Yearly,Line7_Medicaid,Line7_TANF,Line7_SSI,Line7_Other,Line8_Name,Line8_Age,Line8_Sex,Line8_Income,Line8_Monthly,Line8_Weekly,Line8_BiWeekly,Line8_Yearly,Line8_Medicaid,Line8_TANF,Line8_SSI,Line8_Other,Line9_Name,Line9_Age,Line9_Sex,Line9_Income,Line9_Monthly,Line9_Weekly,Line9_BiWeekly,Line9_Yearly,Line9_Medicaid,Line9_TANF,Line9_SSI,Line9_Other,Line10_Name,Line10_Age,Line10_Sex,Line10_Income,Line10_Monthly,Line10_Weekly,Line10_BiWeekly,Line10_Yearly,Line10_Medicaid,Line10_TANF,Line10_SSI,Line10_Other,Line11_Name,Line11_Age,Line11_Sex,Line11_Income,Line11_Monthly,Line11_Weekly,Line11_BiWeekly,Line11_Yearly,Line11_Medicaid,Line11_TANF,Line11_SSI,Line11_Other,Line12_Name,Line12_Age,Line12_Sex,Line12_Income,Line12_Monthly,Line12_Weekly,Line12_BiWeekly,Line12_Yearly,Line12_Medicaid,Line12_TANF,Line12_SSI,Line12_Other,Line13_Name,Line13_Age,Line13_Sex,Line13_Income,Line13_Monthly,Line13_Weekly,Line13_BiWeekly,Line13_Yearly,Line13_Medicaid,Line13_TANF,Line13_SSI,Line13_Other,Line14_Name,Line14_Age,Line14_Sex,Line14_Income,Line14_Monthly,Line14_Weekly,Line14_BiWeekly,Line14_Yearly,Line14_Medicaid,Line14_TANF,Line14_SSI,Line14_Other,Line15_Name,Line15_Age,Line15_Sex,Line15_Income,Line15_Monthly,Line15_Weekly,Line15_BiWeekly,Line15_Yearly,Line15_Medicaid,Line15_TANF,Line15_SSI,Line15_Other,Line16_Name,Line16_Age,Line16_Sex,Line16_Income,Line16_Monthly,Line16_Weekly,Line16_BiWeekly,Line16_Yearly,Line16_Medicaid,Line16_TANF,Line16_SSI,Line16_Other,Line17_Name,Line17_Age,Line17_Sex,Line17_Income,Line17_Monthly,Line17_Weekly,Line17_BiWeekly,Line17_Yearly,Line17_Medicaid,Line17_TANF,Line17_SSI,Line17_Other,Line18_Name,Line18_Age,Line18_Sex,Line18_Income,Line18_Monthly,Line18_Weekly,Line18_BiWeekly,Line18_Yearly,Line18_Medicaid,Line18_TANF,Line18_SSI,Line18_Other,Line19_Name,Line19_Age,Line19_Sex,Line19_Income,Line19_Monthly,Line19_Weekly,Line19_BiWeekly,Line19_Yearly,Line19_Medicaid,Line19_TANF,Line19_SSI,Line19_Other,Line20_Name,Line20_Age,Line20_Sex,Line20_Income,Line20_Monthly,Line20_Weekly,Line20_BiWeekly,Line20_Yearly,Line20_Medicaid,Line20_TANF,Line20_SSI,Line20_Other,Line21_Name,Line21_Age,Line21_Sex,Line21_Income,Line21_Monthly,Line21_Weekly,Line21_BiWeekly,Line21_Yearly,Line21_Medicaid,Line21_TANF,Line21_SSI,Line21_Other,Signature1Date,Signature2Date,Signature3Date,Signature4Date,Signature5Date,Signature6Date,Signature1,Signature2,Signature3,Signature4,Signature5,Signature6 FROM Intake INNER JOIN tmpPrintouts ON Intake.ID = tmpPrintouts.OrigID AND tmpPrintouts.ID = 1000000
UNION ALL 
SELECT tmpPrintouts.ID, tmpPrintouts.OrigID, pagenum, '1625-3' AS AgencyNumber,'Loaves & Fishes Food Pantry' AS AgencyName, LastName,CASE pagenum WHEN 1 THEN FirstName ELSE CONCAT(FirstName, " (page ", pagenum, ")") END AS FirstName, Address,City,State,Phone,AptNumber,CASE WHEN FoodStamps = 1 THEN 'Yes' ELSE 'No' END AS ListBox,FoodStampAmount,WorkerName AS NameOfWorker,DoB,Zip,Line1_Name,Line1_Age,Line1_Sex,Line1_Income,Line1_Monthly,Line1_Weekly,Line1_BiWeekly,Line1_Yearly,Line1_Medicaid,Line1_TANF,Line1_SSI,Line1_Other,Line2_Name,Line2_Age,Line2_Sex,Line2_Income,Line2_Monthly,Line2_Weekly,Line2_BiWeekly,Line2_Yearly,Line2_Medicaid,Line2_TANF,Line2_SSI,Line2_Other,Line3_Name,Line3_Age,Line3_Sex,Line3_Income,Line3_Monthly,Line3_Weekly,Line3_BiWeekly,Line3_Yearly,Line3_Medicaid,Line3_TANF,Line3_SSI,Line3_Other,Line4_Name,Line4_Age,Line4_Sex,Line4_Income,Line4_Monthly,Line4_Weekly,Line4_BiWeekly,Line4_Yearly,Line4_Medicaid,Line4_TANF,Line4_SSI,Line4_Other,Line5_Name,Line5_Age,Line5_Sex,Line5_Income,Line5_Monthly,Line5_Weekly,Line5_BiWeekly,Line5_Yearly,Line5_Medicaid,Line5_TANF,Line5_SSI,Line5_Other,Line6_Name,Line6_Age,Line6_Sex,Line6_Income,Line6_Monthly,Line6_Weekly,Line6_BiWeekly,Line6_Yearly,Line6_Medicaid,Line6_TANF,Line6_SSI,Line6_Other,Line7_Name,Line7_Age,Line7_Sex,Line7_Income,Line7_Monthly,Line7_Weekly,Line7_BiWeekly,Line7_Yearly,Line7_Medicaid,Line7_TANF,Line7_SSI,Line7_Other,Line8_Name,Line8_Age,Line8_Sex,Line8_Income,Line8_Monthly,Line8_Weekly,Line8_BiWeekly,Line8_Yearly,Line8_Medicaid,Line8_TANF,Line8_SSI,Line8_Other,Line9_Name,Line9_Age,Line9_Sex,Line9_Income,Line9_Monthly,Line9_Weekly,Line9_BiWeekly,Line9_Yearly,Line9_Medicaid,Line9_TANF,Line9_SSI,Line9_Other,Line10_Name,Line10_Age,Line10_Sex,Line10_Income,Line10_Monthly,Line10_Weekly,Line10_BiWeekly,Line10_Yearly,Line10_Medicaid,Line10_TANF,Line10_SSI,Line10_Other,Line11_Name,Line11_Age,Line11_Sex,Line11_Income,Line11_Monthly,Line11_Weekly,Line11_BiWeekly,Line11_Yearly,Line11_Medicaid,Line11_TANF,Line11_SSI,Line11_Other,Line12_Name,Line12_Age,Line12_Sex,Line12_Income,Line12_Monthly,Line12_Weekly,Line12_BiWeekly,Line12_Yearly,Line12_Medicaid,Line12_TANF,Line12_SSI,Line12_Other,Line13_Name,Line13_Age,Line13_Sex,Line13_Income,Line13_Monthly,Line13_Weekly,Line13_BiWeekly,Line13_Yearly,Line13_Medicaid,Line13_TANF,Line13_SSI,Line13_Other,Line14_Name,Line14_Age,Line14_Sex,Line14_Income,Line14_Monthly,Line14_Weekly,Line14_BiWeekly,Line14_Yearly,Line14_Medicaid,Line14_TANF,Line14_SSI,Line14_Other,Line15_Name,Line15_Age,Line15_Sex,Line15_Income,Line15_Monthly,Line15_Weekly,Line15_BiWeekly,Line15_Yearly,Line15_Medicaid,Line15_TANF,Line15_SSI,Line15_Other,Line16_Name,Line16_Age,Line16_Sex,Line16_Income,Line16_Monthly,Line16_Weekly,Line16_BiWeekly,Line16_Yearly,Line16_Medicaid,Line16_TANF,Line16_SSI,Line16_Other,Line17_Name,Line17_Age,Line17_Sex,Line17_Income,Line17_Monthly,Line17_Weekly,Line17_BiWeekly,Line17_Yearly,Line17_Medicaid,Line17_TANF,Line17_SSI,Line17_Other,Line18_Name,Line18_Age,Line18_Sex,Line18_Income,Line18_Monthly,Line18_Weekly,Line18_BiWeekly,Line18_Yearly,Line18_Medicaid,Line18_TANF,Line18_SSI,Line18_Other,Line19_Name,Line19_Age,Line19_Sex,Line19_Income,Line19_Monthly,Line19_Weekly,Line19_BiWeekly,Line19_Yearly,Line19_Medicaid,Line19_TANF,Line19_SSI,Line19_Other,Line20_Name,Line20_Age,Line20_Sex,Line20_Income,Line20_Monthly,Line20_Weekly,Line20_BiWeekly,Line20_Yearly,Line20_Medicaid,Line20_TANF,Line20_SSI,Line20_Other,Line21_Name,Line21_Age,Line21_Sex,Line21_Income,Line21_Monthly,Line21_Weekly,Line21_BiWeekly,Line21_Yearly,Line21_Medicaid,Line21_TANF,Line21_SSI,Line21_Other,Signature1Date,Signature2Date,Signature3Date,Signature4Date,Signature5Date,Signature6Date,Signature1,Signature2,Signature3,Signature4,Signature5,Signature6 FROM Intakelog INNER JOIN tmpPrintouts ON tmpPrintouts.ID = intakelog.ID  AND tmpPrintouts.ID < 1000000
) dt0 WHERE OrigID IN (
SELECT ID FROM intake WHERE (Signature1 IS NOT NULL OR Signature2 IS NOT NULL OR Signature3 IS NOT NULL OR Signature4 IS NOT NULL OR Signature5 IS NOT NULL OR Signature6 IS NOT NULL)
 -- AND (Line11_Name IS NULL AND Line12_Name IS NULL AND Line13_Name IS NULL) -- for regular size sheets
 AND (Line11_Name IS NOT NULL OR Line12_Name IS NOT NULL OR Line13_Name IS NOT NULL) -- for over 10 size sheets
 AND (Line2_SSI = 0 OR Line2_SSI IS NULL)
 )

ORDER BY LastName ASC, FirstName ASC;
END $$

DELIMITER ;